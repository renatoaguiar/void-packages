# Template file for 'virtio_vmmci'
pkgname=virtio_vmmci
version=0.4.0
revision=1
depends="dkms"
short_desc="Virtio driver for OpenBSD VMM Control Interface"
maintainer="Renato Aguiar <renato@renatoaguiar.net>"
license="GPL-2.0-only"
homepage="https://github.com/voutilad/virtio_vmmci"
distfiles="https://github.com/voutilad/virtio_vmmci/archive/${version}.tar.gz"
checksum=547abb69054dc342fa261451ec10c44af0898702c5404d6f6aae74f0e7f7b164
dkms_modules="virtio_vmmci ${version}"

do_install() {
	vmkdir usr/src/virtio_vmmci-${version}
	vcopy "*.c" usr/src/virtio_vmmci-${version}
	vcopy "*.h" usr/src/virtio_vmmci-${version}
	vcopy Makefile usr/src/virtio_vmmci-${version}
	vcopy Kconfig usr/src/virtio_vmmci-${version}
	vcopy Kbuild usr/src/virtio_vmmci-${version}
	vinstall ${FILESDIR}/dkms.conf 644 usr/src/virtio_vmmci-${version}
	sed -i -e "s/@VERSION@/${version}/" ${PKGDESTDIR}/usr/src/virtio_vmmci-${version}/dkms.conf
}
